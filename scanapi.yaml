endpoints:
  - name: precadastro
    path: ${BASE_URL}
    requests:
      - name: solicitar
        method: post
        vars:
          possivelAlterarTelefone: false
        path: /api/v1/cadastro/solicitar
        tests:
          - name: status_code_is_200
            assert: ${{ response.status_code == 200 }}
          - name: possivelAlterarTelefone_true
            assert: ${{ response.json().get("possivelAlterarTelefone") == ${possivelAlterarTelefone} }}
        body:
          cpf: ${CPF}
          nome: Tarik Silva
          celular: ${CELULAR}
          dataNascimento: 08/05/1997
          origem: APPDIGITAL
          email: iury@rarolabs.com.br
          canalToken: SMS
      - name: validar
        method: post
        path: /api/v1/cadastro/validar
        tests:
          - name: status_code_is_200
            assert: ${{ response.status_code == 200 }}
        body:
          cpf: ${CPF}
          token: ${TOKEN}
endpoints:
  - name: precadastro2
    requests:
      - name: gerador-cpf
        method: get
        vars:
          cpf_aleatorio: ${{ response.json().get("data").get("number") }}
        path: http://geradorapp.com/api/v1/cpf/generate?token=41afa3b94766614d89e52bbff5478a12
        tests:
          - name: status_code_is_200
            assert: ${{ response.status_code == 200 }}
      - name: solicitar
        method: post
        vars:
          possivelAlterarTelefone: true
        path: https://apisandbox.bancobmg.com.br:8443/api/v1/cadastro/solicitar
        tests:
          - name: status_code_is_200
            assert: ${{ response.status_code == 200 }}
          - name: possivelAlterarTelefone_true
            assert: ${{ response.json().get("possivelAlterarTelefone") == ${possivelAlterarTelefone} }}
        body:
          cpf: ${cpf_aleatorio}
          nome: Tarik Silva
          celular: ${CELULAR}
          dataNascimento: 08/05/1997
          origem: APPDIGITAL
          email: iury@rarolabs.com.br
          canalToken: SMS
  